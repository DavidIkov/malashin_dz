import numpy as np

def gen(n, a, b, p, q, f, alpha, beta):
    """
    Генерирует трехдиагональную систему для уравнения:
    y'' + p(x)y' + q(x)y = f(x)
    с граничными условиями y(a)=alpha, y(b)=beta
    """
    h = (b - a) / (n - 1)
    x = np.linspace(a, b, n)
    
    # Инициализация массивов прогонки
    A = np.zeros(n)  # нижняя диагональ (для i-1)
    B = np.zeros(n)  # главная диагональ (для i)
    C = np.zeros(n)  # верхняя диагональ (для i+1)
    D = np.zeros(n)  # правая часть
    
    # Левое граничное условие: y0 = alpha
    B[0] = 1
    C[0] = 0
    D[0] = alpha
    
    # Правой граничное условие: y_{n-1} = beta
    A[n-1] = 0
    B[n-1] = 1
    D[n-1] = beta
    
    # Внутренние точки
    for i in range(1, n-1):
        A[i] = 1/h**2 - p(x[i])/(2*h)    # коэффициент для y_{i-1}
        B[i] = -2/h**2 + q(x[i])         # коэффициент для y_i
        C[i] = 1/h**2 + p(x[i])/(2*h)    # коэффициент для y_{i+1}
        D[i] = f(x[i])                   # правая часть
    
    return A, B, C, D, x
